# Как выборочно объединить или выбрать изменения из другой ветки в Git?

## Answer #1

Резюме:

Извлечь путь (и) из ветки, которую вы хотите объединить,
```shell
$ git checkout source_branch -- <paths>...

или выборочно объединить куски
```shell
$ git checkout -p source_branch -- <paths>...
```

Или используйте сброс, а затем добавьте с опцией -p,
```shell
$ git reset <paths>...
$ git add -p <paths>...
```
Наконец совершить
```shell
$ git commit -m "'Merge' these changes"
```

---



## Answer #2

Чтобы выборочно объединить файлы из одной ветки в другую ветвь, запустите
```shell
git merge --no-ff --no-commit branchX
```

где branchX - это ветвь, которую вы хотите объединить в текущую ветвь.

Параметр --no-commit будет обрабатывать файлы, которые были объединены с помощью Git без фактической фиксации.
Это даст вам возможность модифицировать объединенные файлы, однако вы хотите, а затем сами их выполнить.

В зависимости от того, как вы хотите объединять файлы, есть четыре случая:

### 1. Требуется истинное слияние.

В этом случае вы принимаете объединенные файлы, так как Git автоматически объединяет их, а затем фиксирует их.

### 2. Есть файлы, которые вы не хотите объединять.

Например, вы хотите сохранить версию в текущей ветке и игнорировать версию в ветке, из которой вы сходите.

Чтобы выбрать версию в текущей ветке, запустите:
```shell
git checkout HEAD file1
```

Это приведет к восстановлению версии file1 в текущей ветке и перезапишет file1, выполненный с помощью Git.

### 3. Если вы хотите версию в branchX (а не истинное слияние).

Run:
```shell
git checkout branchX file1
```

Это приведет к извлечению версии file1 в branchX и перезаписывает file1 автоматически слияние Git.

### 4. В последнем случае вы хотите выбрать только определенные слияния в file1.

В этом случае вы можете отредактировать измененный file1 напрямую, обновить его до того, что вы хотите, чтобы версия 
file1 стала, а затем зафиксировать.

Если Git не может объединить файл автоматически, он будет сообщать файл как "unmerged" и создать копию, где вам 
нужно будет разрешить конфликты вручную.

---

Чтобы пояснить далее пример, предположим, вы хотите объединить branchX в текущую ветку:
```shell
git merge --no-ff --no-commit branchX
```

Затем вы запускаете команду git status для просмотра состояния измененных файлов.

Например:
```shell
git status

# On branch master
# Changes to be committed:
#
#       modified:   file1
#       modified:   file2
#       modified:   file3
# Unmerged paths:
#   (use "git add/rm <file>..." as appropriate to mark resolution)
#
#       both modified:      file4
#
```

Где file1, file2 и file3 - файлы Git успешно скомпилированы.

Это означает, что изменения в master и branchX для всех этих трех файлов были объединены вместе без конфликтов.

Вы можете проверить, как было выполнено слияние, запустив git diff --cached;
```shell
git diff --cached file1
git diff --cached file2
git diff --cached file3
```

#### Если вы обнаружите какое-то нежелательное слияние, вы можете
1. отредактировать файл напрямую
2. сохранить
3. git commit

#### Если вы не хотите объединять file1 и хотите сохранить версию в текущей ветке

Run
```shell
git checkout HEAD file1
```

#### Если вы не хотите объединять file2 и хотите только версию в branchX

Run
```shell
git checkout branchX file2
```

#### Если вы хотите, чтобы file3 был объединен автоматически, ничего не делайте.

Git уже объединил его в этот момент.


file4 выше - неудавшееся слияние на Git. Это означает, что в обеих ветвях есть изменения, которые происходят в одной строке. Здесь вам нужно будет разрешить конфликты вручную. Вы можете отказаться от слияния, отредактировав файл напрямую или запустив команду проверки для версии в ветке, которую хотите file4 стать.


__Наконец, не забудьте git commit.__

---


## Answer #3. Как копировать отдельные файлы из другой ветки.

Предположим, вы находитесь в ветке master и хотите смержить файл из ветки dev, используйте следующий синтаксис:
```shell
git checkout <BRANCH_NAME> <PATH_OF_FILE>
```
```shell
git checkout dev views/default/menu.html
```

Если вы хотите, смержить сразу несколько выбранных файлов:
```shell
git checkout <BRANCH_NAME> <PATH_OF_FILE_1> <PATH_OF_FILE_2> <PATH_OF_FILE_3>
```

После того как вы сделаете это, этот конкретный файл из ветки dev будет добавлен к ветке master.
